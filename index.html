<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>PipesJs/Core by pipesjs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">PipesJs/Core</h1>
      <h2 class="project-tagline">Basic utilities for web streams</h2>
      <a href="https://github.com/pipesjs/core" class="btn">View on GitHub</a>
      <a href="https://github.com/pipesjs/core/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/pipesjs/core/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="pipesjs" class="anchor" href="#pipesjs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pipesjs</h1>

<p><code>pipesjs</code> includes an evolving bunch of modules of utilities and helpers for <a href="https://streams.spec.whatwg.org"><code>web streams</code></a>.</p>

<hr>

<h1>
<a id="pipes-core" class="anchor" href="#pipes-core" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pipes/ core</h1>

<h2>
<a id="contents" class="anchor" href="#contents" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contents</h2>

<ul>
<li><a href="#about">About</a></li>
<li><a href="#installing">Installing</a></li>
<li><a href="#api-reference">API Reference</a></li>
</ul>

<h2>
<a id="about" class="anchor" href="#about" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>About</h2>

<p>The <code>core</code> module contains some basic utility functions to make working with <code>web streams</code> a lot easier. Here's more about <code>Web Streams</code> from the <a href="https://streams.spec.whatwg.org">spec</a> itself:</p>

<blockquote>
<p>Large swathes of the web platform are built on streaming data: that is, data that is created, processed, and consumed in an incremental fashion, without ever reading all of it into memory. The Streams Standard provides a common set of APIs for creating and interfacing with such streaming data, embodied in readable streams, writable streams, and transform streams.</p>
</blockquote>

<p>The spec is still evolving but has reached a fairly stable stage with a <a href="https://github.com/whatwg/streams/tree/master/reference-implementation">reference implementation</a> as well. The API has almost been finalized and <code>Stream</code>s are coming to the web very soon!</p>

<p>At it's core, the API exposes three major components:</p>

<ul>
<li>
<code>ReadableStream</code> encapsulates a source producing values and emits them.</li>
<li>
<code>TransformStream</code> are essentially <code>{ readable, writable}</code> pairs that take a function which can be used to transform the values flowing through it.</li>
<li>
<p><code>WritableStream</code> encapsulates a sink that receives values and writes to it.</p>

<p><code>Stream</code>s are essentially data structures that handle sequential flow of values. You can split streams, merge them and connect them together in various ways. What's amazing is that, in most cases, they can handle <a href="https://streams.spec.whatwg.org/#pipe-chains">backpressure</a> automatically, so you don't have to mess with the underlying details.</p>
</li>
</ul>

<p>For further information, the spec is quite informative and easy to read. <a href="https://github.com/jakearchibald">Jake Archibald</a> also wrote a great <a href="https://jakearchibald.com/2016/streams-ftw/">blog post</a> on them.</p>

<p><strong>Heads up:</strong> If you're coming from <code>node</code> land, <code>web streams</code> are quite a lot different from <code>node streams</code> and incompatible with each other.</p>

<h2>
<a id="installing" class="anchor" href="#installing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installing</h2>

<h3>
<a id="for-browsers" class="anchor" href="#for-browsers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For browsers</h3>

<p>The library depends on a <a href="https://github.com/creatorrr/web-stream-polyfill">polyfill</a> for browsers that don't support <code>Stream</code> APIs yet (which as of now, is all of them), so make sure you include it in before including the library.</p>

<p>You can use either of the builds from the <code>dist</code> folder:</p>

<div class="highlight highlight-text-html-basic"><pre><span class="pl-s1">    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>path/to/web-streams-polyfill.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
<span class="pl-s1">    &lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>path/to/pipes.core.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span></pre></div>

<p>And in your code, all the functions will be available on the <code>window.Pipes</code> variable.</p>

<div class="highlight highlight-source-js"><pre>
    <span class="pl-k">let</span> { pipe, flatten } <span class="pl-k">=</span> <span class="pl-c1">window</span>.<span class="pl-smi">Pipes</span>;

    <span class="pl-en">flatten</span>(<span class="pl-c">/* some streams here */</span>);</pre></div>

<h3>
<a id="for-browserify-users" class="anchor" href="#for-browserify-users" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For browserify users</h3>

<p>The library has a <a href="https://nodejs.org/en/blog/npm/peer-dependencies/">peer-dependency</a> on <a href="https://github.com/creatorrr/web-stream-polyfill">web-streams-polyfill</a>, so to install it:</p>

<div class="highlight highlight-source-shell"><pre>
    npm install web-streams-polyfill @pipes/core
</pre></div>

<p>The library is split up into modules, so you can both require the whole library or only parts of it:</p>

<div class="highlight highlight-source-js"><pre>
    <span class="pl-k">let</span> { flatten } <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>@pipes/core<span class="pl-pds">"</span></span>);
    <span class="pl-k">let</span> merge <span class="pl-k">=</span> <span class="pl-c1">require</span>(<span class="pl-s"><span class="pl-pds">"</span>@pipes/core/merge<span class="pl-pds">"</span></span>);</pre></div>

<h3>
<a id="for-es6-and-rollup-users" class="anchor" href="#for-es6-and-rollup-users" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For ES6 and Rollup users</h3>

<p>If you want, you can directly import the es6 modules like so:</p>

<div class="highlight highlight-source-js"><pre>
    <span class="pl-k">import</span> <span class="pl-smi">pipes</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">"</span>@pipes/core/src<span class="pl-pds">"</span></span>;
    <span class="pl-k">import</span> { <span class="pl-smi">flatten</span> } <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">"</span>@pipes/core/src<span class="pl-pds">"</span></span>;
    <span class="pl-k">import</span> <span class="pl-smi">flatten</span> <span class="pl-k">from</span> <span class="pl-s"><span class="pl-pds">"</span>@pipes/core/src/flatten<span class="pl-pds">"</span></span>;</pre></div>

<h2>
<a id="api-reference" class="anchor" href="#api-reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Reference</h2>

<p>The library only consists of the following functions:</p>

<ul>
<li> <a href="#pipe">pipe</a>
</li>
<li> <a href="#pipeasync">pipe.async</a>
</li>
<li> <a href="#chain">chain</a>
</li>
<li> <a href="#connect">connect</a>
</li>
<li> <a href="#flatten">flatten</a>
</li>
<li> <a href="#merge">merge</a>
</li>
<li> <a href="#zip">zip</a>
</li>
<li> <a href="#split">split</a>
</li>
</ul>

<h3>
<a id="pipe" class="anchor" href="#pipe" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pipe</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">pipe</span> (
  <span class="pl-c1">Function</span> <span class="pl-k">|</span> Generator <span class="pl-c1">Function</span>,
  <span class="pl-c1">Object</span> {
    init,   <span class="pl-c">// value to initiate transform stream</span>
    writableStrategy,
    readableStrategy    <span class="pl-c">// instances of queuing strategies</span>
  }
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> TransformBlueprint <span class="pl-c">// Constructor that returns transform stream</span></pre></div>

<p><code>pipe</code> function takes a transform function or generator and an opts object; returns a TransforBlueprint that can be used to create <code>transform streams</code>.</p>

<p>If a <code>Generator Function</code> is passed, it is consumed entirely on each transform call and results enqueud. Backpressure is handled automatically and if <code>stream</code> is cancelled, any live <code>generator</code> is gracefully shutdown. On shutdown, <code>generator</code> is sent <code>true</code> as a signal to prepare shutdown.</p>

<p>If the function doesn't return anything or returns <code>undefined</code>, nothing is written on the stream.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-c">// Setup</span>
<span class="pl-k">let</span> createReadable <span class="pl-k">=</span> data <span class="pl-k">=&gt;</span> <span class="pl-k">new</span> <span class="pl-en">ReadableStream</span>({
    <span class="pl-en">start</span> (<span class="pl-smi">controller</span>) {
      <span class="pl-v">this</span>.<span class="pl-c1">data</span> <span class="pl-k">=</span> data <span class="pl-k">||</span> [<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>];

      <span class="pl-c">// Kickstart stream</span>
      <span class="pl-smi">controller</span>.<span class="pl-en">enqueue</span>( <span class="pl-v">this</span>.<span class="pl-c1">data</span>.<span class="pl-c1">pop</span>() );
    },
    <span class="pl-en">pull</span> (<span class="pl-smi">controller</span>) {
      <span class="pl-k">if</span> ( <span class="pl-k">!</span><span class="pl-v">this</span>.<span class="pl-c1">data</span>.<span class="pl-c1">length</span> )
        <span class="pl-k">return</span> <span class="pl-smi">controller</span>.<span class="pl-c1">close</span>()

      <span class="pl-smi">controller</span>.<span class="pl-en">enqueue</span>( <span class="pl-v">this</span>.<span class="pl-c1">data</span>.<span class="pl-c1">pop</span>() );
    }
  }),
  <span class="pl-en">createWritable</span> <span class="pl-k">=</span> () <span class="pl-k">=&gt;</span> <span class="pl-k">new</span> <span class="pl-en">WritableStream</span>({
    <span class="pl-en">write</span> (<span class="pl-smi">chunk</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>( chunk );
    }
  });

<span class="pl-c">// Pure funtion example</span>
<span class="pl-k">let</span> negator <span class="pl-k">=</span> <span class="pl-en">pipe</span>( n <span class="pl-k">=&gt;</span> <span class="pl-k">-</span>n ),
  rIn <span class="pl-k">=</span> <span class="pl-en">createReadable</span>(),
  rOut;

rOut <span class="pl-k">=</span> <span class="pl-smi">rIn</span>.<span class="pl-en">pipeThrough</span>( <span class="pl-k">new</span> <span class="pl-en">negator</span> );  <span class="pl-c">// -1, -2, -3</span>


<span class="pl-c">// Basic generator example</span>
<span class="pl-k">let</span> doubler <span class="pl-k">=</span> <span class="pl-en">pipe</span>( <span class="pl-k">function*</span> (<span class="pl-smi">v</span>) {
    <span class="pl-k">yield</span> v;
    <span class="pl-k">yield</span> v;
  }),
  rIn <span class="pl-k">=</span> <span class="pl-en">createReadable</span>(),
  rOut;

rOut <span class="pl-k">=</span> <span class="pl-smi">rIn</span>.<span class="pl-en">pipeThrough</span>( <span class="pl-k">new</span> <span class="pl-en">doubler</span> );  <span class="pl-c">// 1, 1, 2, 2, 3, 3</span>


<span class="pl-c">// Infinite generator example</span>

<span class="pl-k">let</span> inf <span class="pl-k">=</span> <span class="pl-en">pipe</span>( <span class="pl-k">function*</span> (<span class="pl-smi">v</span>) {
    <span class="pl-c">// Close on shutdown signal</span>
    <span class="pl-k">while</span>( <span class="pl-k">!</span>( <span class="pl-k">yield</span> v ));
  }, {
    init<span class="pl-k">:</span> <span class="pl-c1">1</span>
  });

<span class="pl-k">new</span> <span class="pl-en">inf</span>;    <span class="pl-c">// 1, 1, 1, 1...</span></pre></div>

<h3>
<a id="pipeasync" class="anchor" href="#pipeasync" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pipe.async</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">pipe</span>.<span class="pl-en">async</span> (
  Async <span class="pl-c1">Function</span>,
  <span class="pl-c1">Object</span> {
    init,   <span class="pl-c">// value to initiate transform stream</span>
    writableStrategy,
    readableStrategy    <span class="pl-c">// instances of queuing strategies</span>
  }
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> TransformBlueprint <span class="pl-c">// Constructor that returns transform stream</span></pre></div>

<p><code>pipe.async</code> function takes an async function and an opts object; returns a TransforBlueprint that can be used to create <code>transform streams</code>.</p>

<p>If an <code>Async Function</code> is passed, it is run on each transform call and results awaited and then enqueud. Backpressure is handled automatically and if <code>stream</code> is cancelled, any live <code>future</code>s is gracefully shutdown.</p>

<p>If the function doesn't return anything or returns <code>undefined</code>, nothing is written on the stream.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-c">// Basic async example</span>
<span class="pl-k">let</span> serverTalker <span class="pl-k">=</span> <span class="pl-smi">pipe</span>.<span class="pl-en">async</span>( <span class="pl-k">async</span> <span class="pl-k">function</span> (<span class="pl-smi">msg</span>) {
    <span class="pl-k">let</span> response <span class="pl-k">=</span> <span class="pl-k">await</span> <span class="pl-en">sendToServer</span>( msg );
    <span class="pl-k">return</span> response;
  }),
  rIn <span class="pl-k">=</span> <span class="pl-en">createReadable</span>(),
  rOut;

rOut <span class="pl-k">=</span> <span class="pl-smi">rIn</span>.<span class="pl-en">pipeThrough</span>( <span class="pl-k">new</span> <span class="pl-en">serverTalker</span> );  <span class="pl-c">// {response}, {response}, {response}</span>
</pre></div>

<h3>
<a id="chain" class="anchor" href="#chain" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>chain</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">chain</span> (
  <span class="pl-k">...</span><span class="pl-en">TransformStream</span>()
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> { readable, writable }</pre></div>

<p><code>chain</code> takes any number of <code>transform streams</code> and chains them together and returns a <code>transform stream</code> that acts as a composition of the input streams.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-c">// Pure funtion example</span>
<span class="pl-k">let</span> negator <span class="pl-k">=</span> <span class="pl-en">pipe</span>( n <span class="pl-k">=&gt;</span> <span class="pl-k">-</span>n ),
  doubler <span class="pl-k">=</span> <span class="pl-en">pipe</span>( n <span class="pl-k">=&gt;</span> <span class="pl-c1">2</span><span class="pl-k">*</span>n ),
  composed <span class="pl-k">=</span> <span class="pl-en">chain</span>( <span class="pl-k">new</span> <span class="pl-en">negator</span>, <span class="pl-k">new</span> <span class="pl-en">doubler</span> ),
  rIn <span class="pl-k">=</span> <span class="pl-en">createReadable</span>(),
  rOut;

rOut <span class="pl-k">=</span> <span class="pl-smi">rIn</span>.<span class="pl-en">pipeThrough</span>( composed );  <span class="pl-c">// -2, -4, -6</span>
</pre></div>

<h3>
<a id="connect" class="anchor" href="#connect" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>connect</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">connect</span> (
  <span class="pl-en">ReadableStream</span>() <span class="pl-k">|</span> <span class="pl-en">TransformStream</span>(),
  <span class="pl-k">...</span><span class="pl-en">TransformStream</span>(),
  <span class="pl-k">&lt;</span>Optional<span class="pl-k">&gt;</span> <span class="pl-en">WritableStream</span>()
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ReadableStream</span>() <span class="pl-k">|</span> <span class="pl-en">Promise</span>()</pre></div>

<p><code>connect</code> takes any number of <code>transform streams</code> with an optional <code>readable</code> at the head and a <code>writable</code> at the tail. It connects them together by applying <code>pipeThrough</code> recursively and returns the resulting <code>readable</code> that acts as a composition of the input streams.</p>

<p>In case, a <code>writable</code> is passed at the tail, the resulting <code>readable</code> is <code>pipeTo</code>d and the resulting <code>promise</code> is returned.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-k">let</span> readable <span class="pl-k">=</span> <span class="pl-en">createReadable</span>(),
  writable <span class="pl-k">=</span> <span class="pl-en">createWritable</span>(),
  passThrough <span class="pl-k">=</span> <span class="pl-en">pipe</span>( k <span class="pl-k">=&gt;</span> k );

<span class="pl-k">let</span> promise <span class="pl-k">=</span> <span class="pl-en">connect</span>( readable, passThrough, writable );   <span class="pl-c">// 1, 2, 3</span></pre></div>

<h3>
<a id="flatten" class="anchor" href="#flatten" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>flatten</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">flatten</span> (
  <span class="pl-k">...</span><span class="pl-en">ReadableStream</span>()
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ReadableStream</span>()</pre></div>

<p><code>flatten</code> takes any number of <code>readable streams</code> and returns a new <code>readable stream</code> with chunks enqueued as they are produced by the input streams, in order they are produced.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-k">let</span> r1 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>]),
  r2 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">4</span>,<span class="pl-c1">5</span>,<span class="pl-c1">6</span>]),
  writable <span class="pl-k">=</span> <span class="pl-en">createWritable</span>(),
  flattened <span class="pl-k">=</span> <span class="pl-en">flatten</span>(r1,r2);

<span class="pl-smi">flattened</span>.<span class="pl-en">pipeTo</span>( writable );   <span class="pl-c">// 1,4,2,5,3,6   (order depends on order received so may vary)</span></pre></div>

<h3>
<a id="merge" class="anchor" href="#merge" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>merge</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">merge</span> (
  <span class="pl-k">...</span><span class="pl-en">ReadableStream</span>()
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ReadableStream</span>()</pre></div>

<p><code>merge</code> takes any number of <code>readable streams</code> and returns a new <code>readable stream</code> with arrays of chunks produced by all the input streams enqueued. It waits for all the streams to produce a value before grouping them together. Resulting stream closes when any of the input streams does.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-k">let</span> r1 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>]),
  r2 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">4</span>,<span class="pl-c1">5</span>,<span class="pl-c1">6</span>,<span class="pl-c1">7</span>]),
  writable <span class="pl-k">=</span> <span class="pl-en">createWritable</span>(),
  merged <span class="pl-k">=</span> <span class="pl-en">merge</span>(r1,r2);

<span class="pl-smi">merged</span>.<span class="pl-en">pipeTo</span>( writable );   <span class="pl-c">// [1,4], [2,5], [3,6]</span></pre></div>

<h3>
<a id="zip" class="anchor" href="#zip" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>zip</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">zip</span> (
  <span class="pl-en">ReadableStream</span>()<span class="pl-k">&lt;</span><span class="pl-c1">Function</span><span class="pl-k">&gt;</span>,
  <span class="pl-k">...</span><span class="pl-en">ReadableStream</span>()
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> <span class="pl-en">ReadableStream</span>()</pre></div>

<p><code>zip</code> takes a <code>readable</code> producing functions and any number of <code>readable streams</code> and returns a new <code>readable stream</code> with the results of functions applied to corresponding chunks produced by the rest input streams enqueued. It waits for all the streams to produce a value before zipping them together. Resulting stream closes when any of the input streams does.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-k">let</span> <span class="pl-en">add</span> <span class="pl-k">=</span> (<span class="pl-smi">a</span>, <span class="pl-smi">b</span>) <span class="pl-k">=&gt;</span> a <span class="pl-k">+</span> b,
  rFn <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([add,add,add]),
  r1 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>]),
  r2 <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">4</span>,<span class="pl-c1">5</span>,<span class="pl-c1">6</span>]),
  writable <span class="pl-k">=</span> <span class="pl-en">createWritable</span>(),
  zipped <span class="pl-k">=</span> <span class="pl-en">zip</span>(rFn,r1,r2);

<span class="pl-smi">zipped</span>.<span class="pl-en">pipeTo</span>( writable );   <span class="pl-c">// 5, 7, 9</span></pre></div>

<h3>
<a id="split" class="anchor" href="#split" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>split</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">split</span> (
  <span class="pl-en">ReadableStream</span>(),
  <span class="pl-en">Int</span> (<span class="pl-k">default</span><span class="pl-k">=</span><span class="pl-c1">2</span>)
) <span class="pl-k">-</span><span class="pl-k">&gt;</span> [<span class="pl-k">...</span><span class="pl-en">ReadableStream</span>()]</pre></div>

<p><code>split</code> takes a <code>readable</code> and a number of branches, returns an array of <code>readable</code>s that are copies of the original. <code>ReadableStream().tee</code> is called repeatedly to produce the branches.</p>

<p>To cancel the original stream, all the branches must be canceled first. Hence the resulting branches have an added <code>cancelAll()</code> method that cancels all the branches and the original stream.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-k">let</span> readable <span class="pl-k">=</span> <span class="pl-en">createReadable</span>([<span class="pl-c1">1</span>,<span class="pl-c1">2</span>,<span class="pl-c1">3</span>]),
  [r1, r2] <span class="pl-k">=</span> <span class="pl-en">split</span>( readable ),
  w1 <span class="pl-k">=</span> <span class="pl-en">createWritable</span>(),
  w2 <span class="pl-k">=</span> <span class="pl-en">createWritable</span>();

<span class="pl-smi">r1</span>.<span class="pl-en">pipeTo</span>( w1 );   <span class="pl-c">// 1, 2, 3</span>
<span class="pl-smi">r2</span>.<span class="pl-en">pipeTo</span>( w2 );   <span class="pl-c">// 1, 2, 3</span></pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/pipesjs/core">PipesJs/Core</a> is maintained by <a href="https://github.com/pipesjs">pipesjs</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
